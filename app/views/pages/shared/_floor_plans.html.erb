<script type="text/javascript">
  $(document).ready(function(){
    $.app.pages.shared.floor_plans.apartments = JSON.parse('<%= raw @apartments_json %>');
  });
</script>
<section id="preloader-container">
  LOADING: <span id="percents">0</span>%
</section>
<div class="common" style="height:100%">
  <!--  <section id="order-form-container" class="hidden">
      <div id="order-form-dialog">
        <%= form_for :order, url: create_order_path do |f| %>
          Ваше имя: <%= f.text_field :name %><br />
          Ваш e-mail: <%= f.text_field :email %><br />
          <%= f.hidden_field :apartment_id %>
        <% end %>
      </div>
    </section>
  -->
    <div class="house-image-container" id="house-image-container" >
      <% (1..6).to_a.reverse.each do |floor_number| %>
        <div class="floor_number n_<%= floor_number %>"> 
          <% if floor_number==6 %>
            <%= link_to '#', :class => 'show-house-floor penthouse', 'data-floor-number' => floor_number, :dataid => floor_number do %>
              Апартаменты с террасами<span></span>
            <% end %>
            <% end %>
          <%= link_to '#', :class => 'floor_'+floor_number.to_s+' show-house-floor', 'data-floor-number' => floor_number, :dataid => floor_number do %>
          <%=floor_number %><span></span>
          <% end %>
        </div>
      <% end %>
    </div>
    <div class="clear"></div>
    <div class="fasad-wrap">
      <span class="floor-text">ЭТАЖИ</span>
      <!--<a href="#" class="side-2" 
        onclick="fasad_to_2()">Внутренний двор</a>
      <a href='#' class="side-1 current_fasad" 
        onclick="fasad_to_1()">Старопетровский проезд</a>
      -->
      <div class="clear"></div>
    </div>
    <section>
      <%= @page.try(:content) %>
    </section>
<script type="text/javascript">
  function fasad_to_2(){
    $('#floor-1').animate({ opacity: 0 }, 2000);
    $('#inset-floor-1').animate({ opacity: 1 }, 2000);
    $('#floor-2').animate({ opacity: 0 }, 2000);
    $('#inset-floor-2').animate({ opacity: 1 }, 2000);
    $('#floor-3').animate({ opacity: 0 }, 2000);
    $('#inset-floor-3').animate({ opacity: 1 }, 2000);
    $('#floor-4').animate({ opacity: 0 }, 2000);
    $('#inset-floor-4').animate({ opacity: 1 }, 2000);
    $('#floor-5').animate({ opacity: 0 }, 2000);
    $('#inset-floor-5').animate({ opacity: 1 }, 2000);
    $('#floor-6').animate({ opacity: 0 }, 2000);
    $('#inset-floor-6').animate({ opacity: 1 }, 2000);
    $('.fasad').animate({ opacity: 0 }, 2000);
    $('.fasad-2').animate({ opacity: 1 }, 2000);
    $('#house-image-container').removeClass('house-image-container');
    $('#house-image-container').addClass('house-image-container-2 ');
    $('.side-1').removeClass('current_fasad');
    $('.side-2').addClass('current_fasad');
    $('#wrapper').hide();
    $('.fasad-bg-wrap').hide();
    $('#big-video-wrap ').show();
    BV.getPlayer().currentTime(0);
    BV.getPlayer().play();
    setTimeout(function(){
      BV = new $.BigVideo({
        useFlashForFirefox:false,
      });
      BV.init();
      BV.show('video/second.webm', {altSource:'video/second.ogv'}, {ambient:true});
      BV.getPlayer().pause();
      $('#wrapper').show();
      $('.fasad-bg-wrap').show();
      BV.getPlayer().remove();
      $('#big-video-wrap ').hide();
    }, 2100);
    var wWidth=$(window).width()
    wLeft=(wWidth/100)*21
    console.log(wWidth)
    $('.house-image-container').find('.floor_number').each(function() {
      if ($(this).hasClass('n_6'))
        {$(this).css('left', wLeft-226+40 + 'px');}
      else
        {$(this).css('left', wLeft  + 'px');}
    });
    $('.house-image-container-2').find('.floor_number').css('left', wLeft + 'px');
    $(".house-image-container-2 .floor_number a")
      .mouseover(function(){
        var curFloor = parseInt($(this).attr("dataid"));
        $("#inset-floor-"+curFloor).addClass("active");
      })
      .mouseout(function(){
        $(".floor-2").removeClass("active");
      });
  };
  function fasad_to_1(){
    $('#floor-1').animate({ opacity: 1 }, 2000);
    $('#inset-floor-1').animate({ opacity: 0 }, 2000);
    $('#floor-2').animate({ opacity: 1 }, 2000);
    $('#inset-floor-2').animate({ opacity: 0 }, 2000);
    $('#floor-3').animate({ opacity: 1 }, 2000);
    $('#inset-floor-3').animate({ opacity: 0 }, 2000);
    $('#floor-4').animate({ opacity: 1 }, 2000);
    $('#inset-floor-4').animate({ opacity: 0 }, 2000);
    $('#floor-5').animate({ opacity: 1 }, 2000);
    $('#inset-floor-5').animate({ opacity: 0 }, 2000);
    $('#floor-6').animate({ opacity: 1 }, 2000);
    $('#inset-floor-6').animate({ opacity: 0 }, 2000);
    $('.fasad-2').animate({ opacity: 0 }, 2000);
    $('.fasad').animate({ opacity: 1 }, 2000);
    $('#house-image-container').removeClass('house-image-container-2');
    $('#house-image-container').addClass('house-image-container');
    $('.side-2').removeClass('current_fasad');
    $('.side-1').addClass('current_fasad');
    $('#wrapper').hide();
    $('.fasad-bg-wrap').hide();
    $('#big-video-wrap ').show();
    BV.getPlayer().currentTime(0);
    BV.getPlayer().play();
    setTimeout(function(){
      BV = new $.BigVideo({
        useFlashForFirefox:false,
      });
      BV.init();
      BV.show('video/first.webm', {altSource:'video/first.ogv'}, {ambient:true});
      BV.getPlayer().pause();
      $('#wrapper').show();
      $('.fasad-bg-wrap').show();
      BV.getPlayer().remove();
      $('#big-video-wrap ').hide();
    }, 2100);
      var wWidth=$(window).width()
      wLeft=(wWidth/100)*21
      console.log(wWidth)
      $('.house-image-container').find('.floor_number').each(function() {
        if ($(this).hasClass('n_6'))
          {$(this).css('left', wLeft-226+40 + 'px');}
        else
          {$(this).css('left', wLeft  + 'px');}
      });
      $('.house-image-container-2').find('.floor_number').css('left', wLeft + 'px');
      $(".house-image-container .floor_number a")
    .mouseover(function(){
      var curFloor = parseInt($(this).attr("dataid"));
      $("#floor-"+curFloor).addClass("active");
    })
    .mouseout(function(){
      $(".floor").removeClass("active");
    });
  };
</script>